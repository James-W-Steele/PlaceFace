<!DOCTYPE html>
<html>
<head>
  <title>Place the Faces</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 20px;
    }
    #question, #finalImage, #introImage {
      max-width: 100%;
      max-height: 300px;
      margin: 20px auto;
      display: block;
    }
    #map {
      max-width: 100%;
      border: 3px solid #000;
      cursor: crosshair;
    }
    #result {
      margin-top: 20px;
      font-size: 1.2em;
    }
    #startScreen, #surveyScreen, #resultsScreen {
      display: none;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      margin-top: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- ðŸ”µ Start Screen -->
<div id="startScreen">
  <h1>Place The Faces!</h1>
  <p>Hi! Thanks for taking my survey!<br>Diversity is a wonderful thing, but it can oftentimes be misunderstood. Oftentimes, even well-intentioned individuals will automatically assume the cultural background of a person at a glance.<br>This misidentification is very hamful, and can make individuals feel excluded or pressure them into acting in a way that does not reflect their true self.<br>Take the survey to test how well you can really identify a person's cultural origin.<br>You will be presented with the faces of 10 people. Try to click the location on the map that you think they're from. At the end, their places of origin will be revealed, and your score will be calculated.<br>Good luck!</p>
  <img id="introImage" src="intro.png" alt="Intro Image">
  <button onclick="startSurvey()">Start</button>
</div>

<!-- ðŸŸ¡ Survey Screen -->
<div id="surveyScreen">
  <img id="question" src="" alt="Question Image">
  <p id="counter">Question 1 of 10</p>
  <img id="map" src="map.png" alt="Map Image">
</div>

<!-- ðŸŸ¢ Results Screen -->
<div id="resultsScreen">
  <h2>Your Results</h2>
  <img id="finalImage" src="final.png" alt="Final Image">
  <p id="result"></p>
</div>

<script>
  const totalQuestions = 10;

  const correctPoints = [
    [312, 116], [368, 480], [310, 265], [1068, 355], [903, 196],
    [619, 218], [855, 256], [682, 157], [1139, 403], [934, 192]
  ]; // Use original size coordinates for map.png

  let current = 1;
  let scores = [];

  const startScreen = document.getElementById('startScreen');
  const surveyScreen = document.getElementById('surveyScreen');
  const resultsScreen = document.getElementById('resultsScreen');

  const questionImg = document.getElementById('question');
  const mapImg = document.getElementById('map');
  const counterText = document.getElementById('counter');
  const resultBox = document.getElementById('result');

  function startSurvey() {
    startScreen.style.display = 'none';
    surveyScreen.style.display = 'block';
    loadQuestion(current);
  }

  function loadQuestion(num) {
    questionImg.src = `img${num}.png`;
    counterText.textContent = `Question ${num} of ${totalQuestions}`;
  }

  mapImg.addEventListener('click', function(event) {
    const rect = mapImg.getBoundingClientRect();
    const xRatio = mapImg.naturalWidth / rect.width;
    const yRatio = mapImg.naturalHeight / rect.height;

    const x = (event.clientX - rect.left) * xRatio;
    const y = (event.clientY - rect.top) * yRatio;

    const [correctX, correctY] = correctPoints[current - 1];
    const dx = x - correctX;
    const dy = y - correctY;
    const distance = Math.sqrt(dx * dx + dy * dy);

    const normalizedScore = Math.max(0, 1 - (distance / 100)); // Scale down based on expected range
    const score = Math.min(1, normalizedScore).toFixed(2); // Clamp to 1.00, round to 2 decimal places
    scores.push(parseFloat(score));

    if (current < totalQuestions) {
      current++;
      loadQuestion(current);
    } else {
      showResults();
    }
  });

  function showResults() {
    surveyScreen.style.display = 'none';
    resultsScreen.style.display = 'block';

    let html = '';
    let total = scores.reduce((a, b) => a + b, 0);
    scores.forEach((s, i) => {
      html += `Question ${i + 1}: ${s.toFixed(2)}<br>`;
    });
    html += `<br><strong>Final Score: ${total.toFixed(2)} / ${totalQuestions.toFixed(2)}</strong>`;
    resultBox.innerHTML = html;
  }

  // Show start screen on load
  startScreen.style.display = 'block';
</script>

</body>
</html>
